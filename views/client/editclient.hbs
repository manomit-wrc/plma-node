{{#content "style" mode="prepend"}}
<link rel="stylesheet" type="text/css" href="/assets/css/dataTables.bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="/assets/css/select2.min.css">
<link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-datetimepicker.min.css">
<link rel="stylesheet" type="text/css" href="/assets/css/jquery.tagsinput.css">
<link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-multiselect.css">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/css/bootstrap-select.min.css" /> {{/content}}
<div class="page-wrapper">
	<div class="content container-fluid">
		<div class="row">
			{{#if error_message}}
			<div class="alert alert-danger">
				<strong>Error! </strong>{{error_message}}
			</div>
			{{/if}}
			<div class="col-sm-8">
				<h4 class="page-title">Edit Client</h4>
			</div>
		</div>
		<form id="clientform" method="POST" action="/client/editClient/{{client.id}}">
			<input type="hidden" name="_csrf" value="{{csrfToken}}">
			<input type="hidden" value="{{client.id}}" id="id" />
			<input type="hidden" id="activity_type_details" name="activity_type_details" value="{{client.tag_type}}">
			<input type="hidden" value="{{client.client_type}}" id="_contactInformation" />

			<div class="form-inline m-b-15">
				<div class="form-group m-r-5">
					<label class="input-group">
						<span class="input-group-addon">
							<input type="radio" id="individual_client" name="client_type" value="I" {{#if_eq client.client_type "I"}} checked {{/if_eq}}
							 disabled />
						</span>
						<div class="form-control form-control-static">Individual</div>
						<span class="glyphicon form-control-feedback"></span>
					</label>
				</div>
				<div class="form-group ">
					<label class="input-group">
						<span class="input-group-addon">
							<input type="radio" id="organization_client" name="client_type" value="O" {{#if_eq client.client_type "O"}} checked {{/if_eq}}
							 disabled />
						</span>
						<div class="form-control form-control-static">Organization</div>
						<span class="glyphicon form-control-feedback"></span>
					</label>
				</div>
			</div>

			<div class="card-box">
				<h3 class="card-title">Basic Information</h3>
				<div class="row">
					<div class="col-md-12">
						<div id="org_type" {{#if_eq client.client_type "I"}} style="display: none;" {{/if_eq}}>
							<div class="col-md-12">
								<div class="form-group form-focus">
									<label class="control-label">Organisation Name <span class="req-lbl">*</span> </label>
									<input type="text" class="form-control floating" id="org_name" name="org_name" value="{{client.organization_name}}" />
								</div>
							</div>

							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Organisation Code</label>
									<input type="text" class="form-control floating" id="org_code" name="org_code" value="{{client.organization_code}}" />
								</div>
							</div>
						</div>
						<div id="individual_type" {{#if_eq client.client_type "O"}} style="display: none;" {{/if_eq}}>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">First Name <span class="req-lbl">*</span> </label>
									<input type="text" class="form-control floating" id="edit_client_first_name" name="edit_client_first_name" value="{{client.first_name}}"
									/>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Last Name <span class="req-lbl">*</span> </label>
									<input type="text" class="form-control floating" id="edit_client_last_name" name="edit_client_last_name" value="{{client.last_name}}"
									/>
								</div>
							</div>

							<div class="col-md-6">
								<div class="form-inline m-b-15">
									<div class="form-group m-r-5">
										<label class="input-group">
											<span class="input-group-addon">
												<input type="radio" id="new-add-tag" name="add_tag" value="n" {{#if_eq client.tag_type 'n'}} checked {{/if_eq}} />
											</span>
											<div class="form-control form-control-static">New Tags</div>
											<span class="glyphicon form-control-feedback"></span>
										</label>
									</div>
									<div class="form-group">
										<label class="input-group">
											<span class="input-group-addon">
												<input type="radio" id="existing-tag" name="add_tag" value="e" {{#if_eq client.tag_type 'e'}} checked {{/if_eq}} />
											</span>
											<div class="form-control form-control-static">Existing Tags</div>
											<span class="glyphicon form-control-feedback"></span>
										</label>
									</div>
								</div>
							</div>
							<div class="col-md-6">
								<div id="add-tag-existing-client" style="display: none;">
									<div class="form-group form-focus select-focus">
										<select id="select-existing-tags" name="existing_tags" class="form-control floating" multiple="multiple">
											{{#each tags}}
											<option value="{{this.id}}" {{#inArray ../existing_tag this.id}} selected="selected" {{/inArray}}>{{this.tags}}</option>
											{{/each}}
										</select>
									</div>
								</div>
								<div id="add-tag-client">
									<div class="form-group form-focus">
										<label class="control-label">Add New Tags</label>
										<input type="text" class="form-control floating" id="add-new-tags" name="add_new_tags" value="{{client.tags}}" />
									</div>
								</div>
							</div>

							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Closing Date<span class="req-lbl">*</span> </label>
									<div class="cal-icon">
										<input class="form-control floating datetimepicker" type="text" id="revenueclosingDate" name="revenueclosingDate" value="{{dateFormat client.revenueclosingDate "
										 DD-MM-YYYY "}}" >
									</div>
								</div>
							</div>

							<div class="col-md-6">
								<div class="form-group form-focus select-focus select-attorney">
									<label class="control-label">Gender<span class="req-lbl">*</span></label>
									<select class="form-control floating " id="client_gender" name="client_gender" >
										<option value="">Select Gender</option>
										<option value="M" {{#if_eq client.gender "M"}} selected {{/if_eq}}>Male</option>
										<option value="F" {{#if_eq client.gender "F"}} selected {{/if_eq}}>Female</option>
										<option value="O" {{#if_eq client.gender "O"}} selected {{/if_eq}}>Others</option>

									</select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Client Company</label>
									<input type="text" class="form-control floating" id="client_company" name="client_company" value="{{client.client_company}}"
									/>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-focus">
								<label class="control-label">Email Id <span class="req-lbl">*</span> </label>
								<input type="text" class="form-control floating" id="email" name="email" value="{{client.email}}" />
								<span id="uniqueEmail" style="color: red"></span>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-focus">
								<label class="control-label">Phone No. <span class="req-lbl">*</span> </label>
								<input type="text" class="form-control floating number_validator" id="phone_no" name="phone_no" value="{{client.phone_no}}"
								/>
								<span id="uniquePhone" style="color: red"></span>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-focus select-focus">
								<label class="control-label">Mobile No. <span class="req-lbl">*</span> </label>
								<input type="text" class="form-control floating number_validator" id="mobile_no" name="mobile_no" value="{{client.mobile_no}}"
								/>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-focus select-focus">
								<label class="control-label">Fax</label>
								<input type="text" class="form-control floating number_validator" id="fax" name="fax" value="{{client.fax}}" />
							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="card-box">
				<h3 class="card-title">Revenue Information</h3>
				<div class="contact-information revenuePlus" id="contactInformationPlus">
					<button class="btn btn-primary btn-lg masterContactDetailsAdd" id="revenuePlus" data-end-date="{{client_revenue.end_date}}" type="button" title="Add New Planning Period" style="display:none;">
						<i class="fa fa-plus"></i>
					</button>
					<div class="contact-margin">
						<div class="row">
							
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Life Time revenue</label>
									<input class="form-control floating" type="text" id="life_time_revenue" name="life_time_revenue" value="{{client.life_time_revenue}}">
								</div>
							</div>
							
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Start Date
										<span class="req-lbl">*</span>
									</label>
									<div class="cal-icon">
										<input class="form-control floating datetimepicker" type="text" id="clientStartDate" name="clientStartDate" value="{{dateFormat client_revenue.start_date "
												DD-MM-YYYY "}}" >
									</div>
								</div>
							</div>

							<div class="col-md-6">
								<div class="form-group form-focus select-focus select-attorney">
									<label class="control-label">Planning Period (Month)
									</label>
									<select class="form-control floating " id="planning_period" name="planning_period">
										<option value="">Select Planning Period </option>
										<option value="1" {{#if_eq client_revenue.planning_period '1'}} selected {{/if_eq}} >1</option>
										<option value="2" {{#if_eq client_revenue.planning_period '2'}} selected {{/if_eq}} >2</option>
										<option value="3" {{#if_eq client_revenue.planning_period '3'}} selected {{/if_eq}} >3</option>
										<option value="4" {{#if_eq client_revenue.planning_period '4'}} selected {{/if_eq}} >4</option>
										<option value="5" {{#if_eq client_revenue.planning_period '5'}} selected {{/if_eq}} >5</option>
										<option value="6" {{#if_eq client_revenue.planning_period '6'}} selected {{/if_eq}} >6</option>
										<option value="7" {{#if_eq client_revenue.planning_period '7'}} selected {{/if_eq}} >7</option>
										<option value="8" {{#if_eq client_revenue.planning_period '8'}} selected {{/if_eq}} >8</option>
										<option value="9" {{#if_eq client_revenue.planning_period '9'}} selected {{/if_eq}} >9</option>
										<option value="10" {{#if_eq client_revenue.planning_period '10'}} selected {{/if_eq}} >10</option>
										<option value="11" {{#if_eq client_revenue.planning_period '11'}} selected {{/if_eq}} >11</option>
										<option value="12" {{#if_eq client_revenue.planning_period '12'}} selected {{/if_eq}} >12</option>
									</select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">End Date</label>
									<input class="form-control floating datetimepicker" type="text" id="end_date" name="end_date" value="{{dateFormat client_revenue.end_date "DD-MM-YYYY "}}"  readonly>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Estimated Planning Period revenue</label>
									<input class="form-control floating" type="text" id="estimated_revenue" name="estimated_revenue" value="{{client_revenue.estimated_revenue}}" >
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group form-focus">
									<label class="control-label">Current annual revenue</label>
									<input class="form-control floating" type="text" id="current_revenue" name="current_revenue" value="{{client_revenue.current_revenue}}" >
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="planingRevenueClose" style="display:none;">
					<div class="planingRevenueRemove">
						<div class="contact-information" id="contactInformatinClose">
							<button class="btn btn-primary btn-lg masterContactDetailsAdd revenueClose" type="button" title="Remove">
								<i class="fa fa-close"></i>
							</button>
							<div class="contact-margin">
								<div class="row">
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Start Date
												<span class="req-lbl">*</span>
											</label>
											<div class="cal-icon">
												<input class="form-control floating " type="text" id="clientStartDate_new" name="clientStartDate_new">
											</div>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group form-focus select-focus select-attorney">
											<label class="control-label">Planning Period (Month)
											</label>
											<select class="form-control floating " id="planning_period_new" name="planning_period_new">
												<option value="">Select Planning Period </option>
												<option value="1">1</option>
												<option value="2">2</option>
												<option value="3">3</option>
												<option value="4">4</option>
												<option value="5">5</option>
												<option value="6">6</option>
												<option value="7">7</option>
												<option value="8">8</option>
												<option value="9">9</option>
												<option value="10">10</option>
												<option value="11">11</option>
												<option value="12">12</option>
											</select>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">End Date</label>
											<input class="form-control floating datetimepicker" type="text" id="end_date_new" name="end_date_new"   readonly>
										</div>
									</div>

									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Estimated Planning Period revenue</label>
											<input class="form-control floating" type="text" id="estimated_revenue_new" name="estimated_revenue_new" >
										</div>
									</div>
									
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Current annual revenue</label>
											<input class="form-control floating" type="text" id="current_revenue_new" name="current_revenue_new">
										</div>
									</div>
									<div class="col-md-6">
										<button class="btn btn-primary btn-lg" type="button" id="addPlanningPeriodBtn" data-client-id ="{{client.id}}">Add new planning period</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>

			
			<div class="card-box">
				<h3 class="card-title">Attorney Information</h3>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group form-focus select-focus select-attorney">
							<label class="control-label">Attorney
								<span class="req-lbl">*</span>
							</label>
							<select id="attorney_id" name="attorney_id" class="form-control floating " >

								{{#if_eq user.role_id "3"}}
								<option value="{{user.id}}">{{user.first_name}} {{user.last_name}}</option>
								{{else}}
								<option value="">Select Attorney</option>
								{{#if_eq user.is_attorney "1"}}
									<option value="{{user.id}}">{{user.first_name}} {{user.last_name}}</option>
								{{/if_eq}}
								{{#each attorney}}
								<option value="{{this.id}}" {{#if_eq this.id ../client.attorney_id}} selected="selected" {{/if_eq}}>{{this.first_name}}
									{{this.last_name}}</option>
								{{/each}} {{/if_eq}}
							</select>
						</div>
					</div>
				</div>
			</div>

			<div class="card-box">
				<h3 class="card-title">Address</h3>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group form-focus">
							<label class="control-label">Address Line 1 <span class="req-lbl">*</span> </label>
							<input type="text" class="form-control floating" id="address1" name="address1" value="{{client.address1}}" />
						</div>
					</div>
					<div class="col-md-12">
						<div class="form-group form-focus">
							<label class="control-label">Address Line 2</label>
							<input type="text" class="form-control floating" id="address2" name="address2" value="{{client.address2}}" />
						</div>
					</div>
					<div class="col-md-12">
						<div class="form-group form-focus">
							<label class="control-label">Address Line 3</label>
							<input type="text" class="form-control floating" id="address3" name="address3" value="{{client.address_line_3}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus">
							<label class="control-label">Country <span class="req-lbl">*</span> </label>
							<select id="country" name="country" class="form-control floating">
								{{#each country}}
								<option value="{{this.id}}">{{this.name}}</option>
								{{/each}}
							</select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus">
							<label class="control-label">State <span class="req-lbl">*</span> </label>
							<select id="state" name="state" class="form-control floating">
								<option value="">Select State</option>
								{{#each state}}
								<option value="{{this.id}}" {{#if_eq this.id ../client.state}} selected="selected" {{/if_eq}}>{{this.name}}</option>
								{{/each}}
							</select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus">
							<label class="control-label">City <span class="req-lbl">*</span> </label>
							<select id="city" name="city" class="form-control floating">
								<option value="">Select City</option>
								{{#each city}}
								<option value="{{this.id}}" {{#if_eq this.id ../client.city}} selected="selected" {{/if_eq}}>{{this.name}}</option>
								{{/each}}
							</select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus">
							<label class="control-label">Zip Code <span class="req-lbl">*</span> </label>
							<select id="zipcode" name="zipcode" class="form-control floating">
								<option value="">Select Zipcode</option>
								{{#each zipcode}}
								<option value="{{this.id}}" {{#if_eq this.id ../client.pin_code}} selected="selected" {{/if_eq}}>{{this.zip}}</option>
								{{/each}}
							</select>
						</div>
					</div>
				</div>
			</div>


			<div class="card-box" id="m_s_contactInformation" style="display:none;">
				<h3 class="card-title">Contact Information</h3>
				<div id="_contactPlus">
					{{#each contactDetails}}
					<div class="contact-information contactDetailsRemove">

						{{#if_eq @index "0"}}
						<button class="btn btn-primary btn-lg masterContactDetailsAdd" id="_contactDetailsPlus" type="button" title="Remove">
							<i class="fa fa-plus"></i>
						</button>
						{{else}}
						<button class="btn btn-primary btn-lg masterContactDetailsAdd contact-Information-Close" type="button" title="Remove">
							<i class="fa fa-close"></i>
						</button>
						{{/if_eq}}

						<div class="contact-margin">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">First Name
											<span class="req-lbl">*</span>

										</label>
										<input type="text" class="form-control floating" id="contactDetailsFirstName" name="contactDetailsFirstName[]" value="{{this.first_name}}"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">Last Name</label>
										<input type="text" class="form-control floating" id="contactDetailsSecondName" name="contactDetailsSecondName[]" value="{{this.last_name}}"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus select-focus">
										<label class="control-label">Gender
											<span class="req-lbl">*</span>

										</label>
										<select class="select form-control floating" id="contactDetailsGender" name="contactDetailsGender[]">
											<option value="">Select Gender</option>
											<option value="M" {{#if_eq this.gender "M"}} selected {{/if_eq}}>Male</option>
											<option value="F" {{#if_eq this.gender "F"}} selected {{/if_eq}}>Female</option>
											<option value="O" {{#if_eq this.gender "O"}} selected {{/if_eq}}>Others</option>
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">Email Id
											<span class="req-lbl">*</span>

										</label>
										<input type="text" class="form-control floating" id="contactDetailsEmail" name="contactDetailsEmail[]" value="{{this.email}}"
										/>
										<span id="uniqueEmail" style="color: red"></span>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">Phone No.
											<span class="req-lbl">*</span>

										</label>
										<input type="text" class="form-control floating number_validator" id="contactDetailsPhone_no" name="contactDetailsPhone_no[]"
										 maxlength="50" value={{this.phone_no}} />
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">Fax</label>
										<input type="text" class="form-control floating number_validator" id="contactDetailsFax" name="contactDetailsFax[]" maxlength="50"
										 value="{{this.fax}}" />
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group form-focus">
										<label class="control-label">Mobile No.
											<span class="req-lbl">*</span>
										</label>
										<input type="text" class="form-control floating number_validator" id="contactDetailsMobile_no" name="contactDetailsMobile_no[]"
										 maxlength="50" value="{{this.mobile_no}}" />
									</div>
								</div>
							</div>
						</div>
					</div>
					{{/each}}
				</div>
				<div class="contactInformationClose" style="display:none;">
					<div class="contactDetailsRemove">
						<div class="contact-information" id="contactInformatinClose">
							<button class="btn btn-primary btn-lg masterContactDetailsAdd contact-Information-Close" type="button" title="Remove">
								<i class="fa fa-close"></i>
							</button>
							<div class="contact-margin ">
								<div class="row">
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">First Name
												<span class="req-lbl">*</span>

											</label>
											<input type="text" class="form-control floating" name="contactDetailsFirstName[]" />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Last Name</label>
											<input type="text" class="form-control floating" name="contactDetailsSecondName[]" />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus select-focus">
											<label class="control-label">Gender
												<span class="req-lbl">*</span>

											</label>
											<select class="form-control floating" name="contactDetailsGender[]">
												<option value="">Select Gender</option>
												<option value="M">Male</option>
												<option value="F">Female</option>
												<option value="O">Others</option>
											</select>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Email Id
												<span class="req-lbl">*</span>

											</label>
											<input type="text" class="form-control floating" name="contactDetailsEmail[]" />
											<span id="uniqueEmail" style="color: red"></span>
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Phone No.
												<span class="req-lbl">*</span>

											</label>
											<input type="text" class="form-control floating number_validator" name="contactDetailsPhone_no[]" maxlength="50" />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Fax</label>
											<input type="text" class="form-control floating number_validator" name="contactDetailsFax[]" maxlength="50" />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group form-focus">
											<label class="control-label">Mobile No.
												<span class="req-lbl">*</span>
											</label>
											<input type="text" class="form-control floating number_validator" id="contactDetailsMobile_no" name="contactDetailsMobile_no[]"
											 maxlength="50" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="card-box">
				<h3 class="card-title">Other Information</h3>
				<div class="row">
					
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Website</label>
							<input type="text" class="form-control floating url_selector" id="website" name="website" value="{{client.website_url}}"
							/>
						</div>
					</div>
					
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">IM</label>
							<input type="text" class="form-control floating" id="im" name="im" value="{{client.IM}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Company Name</label>
							<input type="text" class="form-control floating" id="company_name" name="company_name" value="{{client.company_name}}" />
						</div>
					</div>
					
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Twitter</label>
							<input type="text" class="form-control floating url_selector" id="twitter" name="twitter" value="{{client.twitter}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Linkedin</label>
							<input type="text" class="form-control floating url_selector" id="linkdn" name="linkdn" value="{{client.linkdn}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Facebook</label>
							<input type="text" class="form-control floating url_selector" id="social" name="social" value="{{client.social_url}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Youtube</label>
							<input type="text" class="form-control floating url_selector" id="youtub" name="youtub" value="{{client.youtub}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus">
							<label class="control-label">Google</label>
							<input type="text" class="form-control floating url_selector" id="google" name="google" value="{{client.google}}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus select-attorney">
							<label class="control-label">Association Status :</label>
							<select id="association" name="association" class="form-control floating " >
								<option value="">Select Association</option>
								<option value="CONVERTED" {{#if_eq client.association_type "CONVERTED"}} selected="selected" {{/if_eq}}>CONVERTED</option>
								<option value="NEW TARGET" {{#if_eq client.association_type "NEW TARGET"}} selected="selected" {{/if_eq}}>NEW TARGET</option>
								<option value="TS-INTERIM" {{#if_eq client.association_type "TS-INTERIM"}} selected="selected" {{/if_eq}}>TS-INTERIM</option>
							</select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group form-focus select-focus select-attorney">
							<label class="control-label">Industry Type :</label>
							<select id="industry_type" name="industry_type" class="form-control floating " >
								<option value="">Select Industry Type</option>
								{{#each industry}}
								<option value="{{this.id}}" {{#if_eq this.id ../client.industry_type}} selected="selected" {{/if_eq}}>{{this.industry_name}}</option>
								{{/each}}
							</select>
						</div>
					</div>
					<div class="col-md-12">
						<div class="form-group form-focus">
							<label class="control-label">Remarks </label>
							<textarea class="form-control floating" id="remarks" name="remarks" rows="5">{{client.remarks}}</textarea>
						</div>
					</div>
				</div>
			</div>

			<div class="text-center m-t-20">
				<button class="btn btn-primary btn-lg" type="submit" id="addclient">Save &amp; Update Client</button>
				<a href="/client" class="btn btn-primary btn-lg m-l-10">Cancel</a>
			</div>
		</form>
	</div>
</div>
{{#content "script" mode="append"}}
<script type="text/javascript" src="/assets/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/assets/js/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="/assets/js/select2.min.js"></script>
<script type="text/javascript" src="/assets/js/moment.min.js"></script>
<script type="text/javascript" src="/assets/js/bootstrap-multiselect.js"></script>
<script type="text/javascript" src="/assets/js/bootstrap-datetimepicker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/additional-methods.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/js/bootstrap-select.min.js"></script>


<script type="text/javascript">
	$(document).ready(function (e) {
		var end_date = $("#revenuePlus").data("end-date");
		if(new Date() > new Date(end_date))
		{
			$("#revenuePlus").show();
		}
		$("#attorney_id").trigger('change');
		$("#current_revenue").inputmask("numeric", {
			radixPoint: ".",
			groupSeparator: ",",
			digits: 2,
			autoGroup: true,
			prefix: '$ ',
			rightAlign: false
		});

		{{!-- $("#current_revenue").inputmask("numeric", {
			radixPoint: ".",
			groupSeparator: ",",
			digits: 2,
			autoGroup: true,
			prefix: '$ ',
			rightAlign: false
		}); --}}

		$("#life_time_revenue").inputmask("numeric", {
			radixPoint: ".",
			groupSeparator: ",",
			digits: 2,
			autoGroup: true,
			prefix: '$ ',
			rightAlign: false
		});
		

		$("#estimated_revenue").inputmask("numeric", {
			radixPoint: ".",
			groupSeparator: ",",
			digits: 2,
			autoGroup: true,
			prefix: '$ ',
			rightAlign: false
		});

		$('#select-existing-tags').multiselect({
			nonSelectedText: 'Select Existing Tags',
			includeSelectAllOption: true,
			buttonWidth: '100%'
		});

		$("#clientform").validate({
			rules: {
				edit_client_first_name: {
					required: true
				},
				edit_client_last_name: {
					required: true
				},
				org_name: {
					required: true
				},
				attorney_id: {
					required: true
				},
				email: {
					required: true,
					email: true
				},
				mobile_no: {
					required: true
				},
				fax: {
					required: true
				},
				address1: {
					required: true
				},
				country: {
					required: true
				},
				state: {
					required: true
				},
				city: {
					required: true
				},
				zipcode: {
					required: true
				},
				phone_no: {
					required: true
				},
				life_time_revenue: {
					required:true
				},
				clientStartDate: {
					required: true
				},
				planning_period: {
					required:true
				},
				
				estimated_revenue: {
					required: true
				},
				current_revenue: {
					required: true
				}
			},
			messages: {
				edit_client_first_name: {
					required: "First name can't be blank"
				},
				edit_client_last_name: {
					required: "Last name can't be blank"
				},
				org_name: {
					required: "Organisation name can't be blank"
				},
				email: {
					required: "Email ID can't be blank",
					email: "Enter valid email ID"
				},
				mobile_no: {
					required: "Mobile number can't be blank"
				},
				fax: {
					required: "Fax can't be blank"
				},
				address1: {
					required: "Must provide address"
				},
				country: {
					required: "Choose your country"
				},
				state: {
					required: "Choose your state"
				},
				city: {
					required: "Choose your city"
				},
				zipcode: {
					required: "Choose your zipcode"
				},
				life_time_revenue: {
					required: "Life time revenue can't be blank"
				},
				clientStartDate: {
					required: "Client Start Date can't be blank"
				},
				planning_period: {
					required: "Choose your Planning period"
				},
				estimated_revenue: {
					required: "Estimated revenue can't be blank"
				},
				current_revenue: {
					required: "Current revenue can't be blank"
				},
			}
		});

		// form validation ends

		var activity_id = $('#activity_type_details').val();

		if (activity_id == 'n') {
			$('#add-tag-client').show();
			$('#add-tag-existing-client').hide();
		} else {
			$('#add-tag-existing-client').show();
			$('#add-tag-client').hide();
		}

		// show hide for add tag and existing tag
		$(document).on('click', '#new-add-tag', function () {
			$('#add-tag-client').show();
			$('#add-tag-existing-client').hide();
		});

		$(document).on('click', '#existing-tag', function () {
			$('#add-tag-existing-client').show();
			$('#add-tag-client').hide();
		})

		let _msType = $('#_contactInformation').val();
		if (_msType === 'O') {
			$('#m_s_contactInformation').show();
		} else {
			$('#m_s_contactInformation').hide();
		}

		//contact information 
		$(document).on('click', '#_contactDetailsPlus', function () {
			$('#_contactPlus').append($('.contactInformationClose').html());
		});

		$(document).on('click', '.contact-Information-Close', function (e) {
			$(this).parents(".contactDetailsRemove").remove();
		});

		//planing period
		$(document).on('click', '#revenuePlus', function () {
		$('.revenuePlus').after($('.planingRevenueClose').html());
		$("#clientStartDate_new").datetimepicker({
			 format: 'DD-MM-YYYY'
		});
		$("#estimated_revenue_new").inputmask("numeric", {
				radixPoint: ".",
				groupSeparator: ",",
				digits: 2,
				autoGroup: true,
				prefix: '$ ',
				rightAlign: false
			});
			$("#current_revenue_new").inputmask("numeric", {
				radixPoint: ".",
				groupSeparator: ",",
				digits: 2,
				autoGroup: true,
				prefix: '$ ',
				rightAlign: false
			});
		$("#revenuePlus").hide();
		});

		$(document).on('click', '.revenueClose', function (e) {
			$(this).parents(".planingRevenueRemove").remove();
			$("#revenuePlus").show();
		});

	});

	$(document).on("change", "#planning_period_new", function () {
			var start_date = $("#clientStartDate_new").val();
			var period = $(this).val();
			if (start_date == "") {
				swal("", "Please Select Start date!", "warning");
				$(this).val('').attr("selected", true);
			} else {
				if ($(this).val() == '') {
					swal("", "Please selcet planning period!", "warning");
					$("#end_date_new").val('');
				} else {
					var start_date_split = start_date.split('-');
					var month = start_date_split[2] + "," + start_date_split[1] + "," + start_date_split[0];
					var current_date = new Date(month);
					var end_date = new Date(current_date.setMonth(current_date.getMonth() + parseInt(period)));
					var dd = end_date.getDate();
					var mm = end_date.getMonth() + 1; //January is 0!
					var yyyy = end_date.getFullYear();
					if (dd < 10) {
						dd = '0' + dd;
					}
					if (mm < 10) {
						mm = '0' + mm;
					}
					var end_date = dd + '-' + mm + '-' + yyyy;
					$("#end_date_new").val(end_date);
				}
			}
		});

	// revenue information
	$(document).on("change", "#planning_period", function(){
		var start_date = $("#clientStartDate").val();
		var period = $(this).val();
		if(start_date == ""){
			alert("1212121212");
		}
		else{
		var start_date_split = start_date.split('-');
		var month = start_date_split[2] + "," + start_date_split[1] + "," + start_date_split[0];
		var current_date = new Date(month);
		var end_date = new Date(current_date.setMonth(current_date.getMonth() + parseInt(period)));
		var dd = end_date.getDate();
			var mm = end_date.getMonth() + 1; //January is 0!

			var yyyy = end_date.getFullYear();
			if (dd < 10) {
				dd = '0' + dd;
			}
			if (mm < 10) {
				mm = '0' + mm;
			}
			var end_date = dd + '-' + mm + '-' + yyyy;
		}
		$("#end_date").val(end_date);
	});

	$(document).on("click", "#addPlanningPeriodBtn", function () {
		var client_id = $(this).data("client-id");
		var start_date_new = $("#clientStartDate_new").val();			
		var estimated_revenue_new = $("#estimated_revenue_new").val();	
		var planning_period_new = $("#planning_period_new").val();	
		var end_date_new = $("#end_date_new").val();	
		if(start_date_new == '')
		{
			swal("","Start date can't be blank","warning");
		}
		else if(planning_period_new == "")
		{
			swal("","please select planning period","warning");
		}		
		else if(estimated_revenue_new == "")
		{
			swal("","Estimated revenue can't be blank","warning");
		}
		else
		{
			swal({
				title: "",
				text: "are you sure you want to set new planning period for this client?",
				type: "warning",
				showCancelButton: true,
				confirmButtonClass: "btn-danger",
				confirmButtonText: "Yes",
				closeOnConfirm: false
			}, function () {
				$.ajax({
					type: 'POST',
					url: '/client/new-planning-period',
					data: { 
						client_id: client_id,
						start_date_new: start_date_new,
						estimated_revenue_new: estimated_revenue_new,
						planning_period_new: planning_period_new,
						end_date_new: end_date_new
					},
					success: function (response) {
						if (response.success === true) {
							swal({
								title: "Nice!",
								text: "New Planning Period Added Successfully!",
								type: "success"
							}, function () {
								window.location.reload();
							});
						}
					},
					error: function (err) {
						console.log(err);
					}
				});
			});
		}		
	});

</script> {{/content}}